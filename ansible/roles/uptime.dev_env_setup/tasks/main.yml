- name: Upgrade servers
  apt:
    update_cache: yes
    upgrade: "yes"

- name: Ensure we have firefox installed
  apt:
    name: firefox
    state: "{{ firefox_state }}"

- name: Ensure we have snap installed
  apt:
    name: snapd
    state: present

- name: Ensure we have vscode installed
  snap:
    name: code
    state: "{{ vscode_state }}"
    classic: yes

- name: Create a nice security hole to fix some snap/vscode bug (server are temporary anyway)
  file:
    path: /run/user
    state: directory
    mode: '1777'
    recurse: yes

- name: Ensure we have LXD installed
  snap:
    name: lxd
    state: "{{ lxd_state }}"

- name: Ensure we have kubectl installed
  snap:
    name: kubectl
    state: "{{ kubectl_state }}"
    classic: yes
 
